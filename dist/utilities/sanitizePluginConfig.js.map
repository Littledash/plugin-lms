{"version":3,"sources":["../../src/utilities/sanitizePluginConfig.ts"],"sourcesContent":["import { defaultAddressFields } from '../fields/defaultAddressFields.js'\nimport type { LMSPluginConfig, SanitizedLMSPluginConfig } from '../types.js'\nimport type { Field } from 'payload'\nimport { AUD } from '../currencies/index.js'\nimport { defaultStudentFields } from '../fields/defaultStudentFields.js'\n\ntype Props = {\n  pluginConfig: LMSPluginConfig\n}\n\nexport const sanitizePluginConfig = ({ pluginConfig }: Props): SanitizedLMSPluginConfig => {\n  const config = {\n    ...pluginConfig,\n  } as Partial<SanitizedLMSPluginConfig>\n\n  if (\n    typeof config.students === 'undefined' ||\n    (typeof config.students === 'boolean' && config.students === true)\n  ) {\n    config.students = {\n      studentsFields: ({ defaultFields }: { defaultFields: Field[] }) => defaultStudentFields(),\n    }\n  } else {\n    const studentFields =\n      (typeof pluginConfig.students === 'object' &&\n        typeof pluginConfig.students.studentsFields === 'function' &&\n        pluginConfig.students.studentsFields({ defaultFields: defaultStudentFields() })) ||\n      defaultStudentFields()\n\n    config.students = {\n      slug: 'users',\n      ...config.students,\n      studentsFields: ({ defaultFields }: { defaultFields: Field[] }) => studentFields,\n    }\n  }\n\n  if (\n    typeof config.addresses === 'undefined' ||\n    (typeof config.addresses === 'boolean' && config.addresses === true)\n  ) {\n    config.addresses = {\n      addressFields: ({ defaultFields }: { defaultFields: Field[] }) => defaultAddressFields(),\n    }\n  } else {\n    const addressFields =\n      (typeof pluginConfig.addresses === 'object' &&\n        typeof pluginConfig.addresses.addressFields === 'function' &&\n        pluginConfig.addresses.addressFields({\n          defaultFields: defaultAddressFields(),\n        })) ||\n      defaultAddressFields()\n\n    config.addresses = {\n      ...config.addresses,\n      addressFields: ({ defaultFields }: { defaultFields: Field[] }) => addressFields,\n    }\n  }\n\n  if (\n    typeof config.endpoints === 'undefined' ||\n    (typeof config.endpoints === 'boolean' && config.endpoints === true)\n  ) {\n    config.endpoints = []\n  } else {\n    config.endpoints = pluginConfig.endpoints\n  }\n\n  if (!config.currencies) {\n    config.currencies = {\n      defaultCurrency: 'AUD',\n      supportedCurrencies: [AUD],\n    }\n  }\n\n    if (typeof config.groups === 'undefined') {\n      config.groups =  true\n    }\n\n    if (typeof config.courses === 'undefined') {\n      config.courses =  true\n    }\n\n    if (typeof config.lessons === 'undefined') {\n      config.lessons =  true\n    }\n\n    if (typeof config.quizzes === 'undefined') {\n      config.quizzes =  true\n    }\n\n    if (typeof config.certificates === 'undefined') {\n      config.certificates =  true\n    }\n\n    if (typeof config.questions === 'undefined') {\n      config.questions =  true\n    }\n\n    if (typeof config.topics === 'undefined') {\n      config.topics =  true\n    }\n    \n    \n  return config as SanitizedLMSPluginConfig\n}\n"],"names":["defaultAddressFields","AUD","defaultStudentFields","sanitizePluginConfig","pluginConfig","config","students","studentsFields","defaultFields","studentFields","slug","addresses","addressFields","endpoints","currencies","defaultCurrency","supportedCurrencies","groups","courses","lessons","quizzes","certificates","questions","topics"],"mappings":"AAAA,SAASA,oBAAoB,QAAQ,oCAAmC;AAGxE,SAASC,GAAG,QAAQ,yBAAwB;AAC5C,SAASC,oBAAoB,QAAQ,oCAAmC;AAMxE,OAAO,MAAMC,uBAAuB,CAAC,EAAEC,YAAY,EAAS;IAC1D,MAAMC,SAAS;QACb,GAAGD,YAAY;IACjB;IAEA,IACE,OAAOC,OAAOC,QAAQ,KAAK,eAC1B,OAAOD,OAAOC,QAAQ,KAAK,aAAaD,OAAOC,QAAQ,KAAK,MAC7D;QACAD,OAAOC,QAAQ,GAAG;YAChBC,gBAAgB,CAAC,EAAEC,aAAa,EAA8B,GAAKN;QACrE;IACF,OAAO;QACL,MAAMO,gBACJ,AAAC,OAAOL,aAAaE,QAAQ,KAAK,YAChC,OAAOF,aAAaE,QAAQ,CAACC,cAAc,KAAK,cAChDH,aAAaE,QAAQ,CAACC,cAAc,CAAC;YAAEC,eAAeN;QAAuB,MAC/EA;QAEFG,OAAOC,QAAQ,GAAG;YAChBI,MAAM;YACN,GAAGL,OAAOC,QAAQ;YAClBC,gBAAgB,CAAC,EAAEC,aAAa,EAA8B,GAAKC;QACrE;IACF;IAEA,IACE,OAAOJ,OAAOM,SAAS,KAAK,eAC3B,OAAON,OAAOM,SAAS,KAAK,aAAaN,OAAOM,SAAS,KAAK,MAC/D;QACAN,OAAOM,SAAS,GAAG;YACjBC,eAAe,CAAC,EAAEJ,aAAa,EAA8B,GAAKR;QACpE;IACF,OAAO;QACL,MAAMY,gBACJ,AAAC,OAAOR,aAAaO,SAAS,KAAK,YACjC,OAAOP,aAAaO,SAAS,CAACC,aAAa,KAAK,cAChDR,aAAaO,SAAS,CAACC,aAAa,CAAC;YACnCJ,eAAeR;QACjB,MACFA;QAEFK,OAAOM,SAAS,GAAG;YACjB,GAAGN,OAAOM,SAAS;YACnBC,eAAe,CAAC,EAAEJ,aAAa,EAA8B,GAAKI;QACpE;IACF;IAEA,IACE,OAAOP,OAAOQ,SAAS,KAAK,eAC3B,OAAOR,OAAOQ,SAAS,KAAK,aAAaR,OAAOQ,SAAS,KAAK,MAC/D;QACAR,OAAOQ,SAAS,GAAG,EAAE;IACvB,OAAO;QACLR,OAAOQ,SAAS,GAAGT,aAAaS,SAAS;IAC3C;IAEA,IAAI,CAACR,OAAOS,UAAU,EAAE;QACtBT,OAAOS,UAAU,GAAG;YAClBC,iBAAiB;YACjBC,qBAAqB;gBAACf;aAAI;QAC5B;IACF;IAEE,IAAI,OAAOI,OAAOY,MAAM,KAAK,aAAa;QACxCZ,OAAOY,MAAM,GAAI;IACnB;IAEA,IAAI,OAAOZ,OAAOa,OAAO,KAAK,aAAa;QACzCb,OAAOa,OAAO,GAAI;IACpB;IAEA,IAAI,OAAOb,OAAOc,OAAO,KAAK,aAAa;QACzCd,OAAOc,OAAO,GAAI;IACpB;IAEA,IAAI,OAAOd,OAAOe,OAAO,KAAK,aAAa;QACzCf,OAAOe,OAAO,GAAI;IACpB;IAEA,IAAI,OAAOf,OAAOgB,YAAY,KAAK,aAAa;QAC9ChB,OAAOgB,YAAY,GAAI;IACzB;IAEA,IAAI,OAAOhB,OAAOiB,SAAS,KAAK,aAAa;QAC3CjB,OAAOiB,SAAS,GAAI;IACtB;IAEA,IAAI,OAAOjB,OAAOkB,MAAM,KAAK,aAAa;QACxClB,OAAOkB,MAAM,GAAI;IACnB;IAGF,OAAOlB;AACT,EAAC"}