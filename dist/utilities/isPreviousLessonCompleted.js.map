{"version":3,"sources":["../../src/utilities/isPreviousLessonCompleted.ts"],"sourcesContent":["import { TypedCollection, DefaultDocumentIDType } from \"payload\"\nimport { CourseProgress, Progress } from \"../providers/types.js\"\n\nexport const isPreviousLessonCompleted = (\n    progress: Progress,\n    course: Pick<TypedCollection['courses'], 'id' | 'title' | 'slug' | 'lessons'>,\n    lessonId: string,\n  ) => {\n    const lessonIndex = course.lessons?.findIndex(\n      (l: { lesson: DefaultDocumentIDType | { id: DefaultDocumentIDType } }) => \n        typeof l.lesson === 'object' && l.lesson !== null && l.lesson.id === lessonId,\n    )\n    const previousLesson = lessonIndex !== undefined && lessonIndex > 0 ? course.lessons?.[lessonIndex - 1] : undefined\n    if (!previousLesson) return true // If there is no previous lesson, then the previous lesson is completed\n    \n    const previousLessonId = typeof previousLesson.lesson === 'object' ? previousLesson.lesson.id : previousLesson.lesson\n    \n    const courseProgress = progress.find((p: CourseProgress) => \n      (typeof p.course === 'object' ? p.course.id : p.course) === course.id\n    )\n    \n    if (!courseProgress) {\n      return false\n    }\n    \n    return (\n      courseProgress.completedLessons.find(\n        (l) => (typeof l.lesson === 'object' ? l.lesson.id : l.lesson) === previousLessonId,\n      ) !== undefined\n    )\n  }"],"names":["isPreviousLessonCompleted","progress","course","lessonId","lessonIndex","lessons","findIndex","l","lesson","id","previousLesson","undefined","previousLessonId","courseProgress","find","p","completedLessons"],"mappings":"AAGA,OAAO,MAAMA,4BAA4B,CACrCC,UACAC,QACAC;IAEA,MAAMC,cAAcF,OAAOG,OAAO,EAAEC,UAClC,CAACC,IACC,OAAOA,EAAEC,MAAM,KAAK,YAAYD,EAAEC,MAAM,KAAK,QAAQD,EAAEC,MAAM,CAACC,EAAE,KAAKN;IAEzE,MAAMO,iBAAiBN,gBAAgBO,aAAaP,cAAc,IAAIF,OAAOG,OAAO,EAAE,CAACD,cAAc,EAAE,GAAGO;IAC1G,IAAI,CAACD,gBAAgB,OAAO,KAAK,wEAAwE;;IAEzG,MAAME,mBAAmB,OAAOF,eAAeF,MAAM,KAAK,WAAWE,eAAeF,MAAM,CAACC,EAAE,GAAGC,eAAeF,MAAM;IAErH,MAAMK,iBAAiBZ,SAASa,IAAI,CAAC,CAACC,IACpC,AAAC,CAAA,OAAOA,EAAEb,MAAM,KAAK,WAAWa,EAAEb,MAAM,CAACO,EAAE,GAAGM,EAAEb,MAAM,AAAD,MAAOA,OAAOO,EAAE;IAGvE,IAAI,CAACI,gBAAgB;QACnB,OAAO;IACT;IAEA,OACEA,eAAeG,gBAAgB,CAACF,IAAI,CAClC,CAACP,IAAM,AAAC,CAAA,OAAOA,EAAEC,MAAM,KAAK,WAAWD,EAAEC,MAAM,CAACC,EAAE,GAAGF,EAAEC,MAAM,AAAD,MAAOI,sBAC/DD;AAEV,EAAC"}